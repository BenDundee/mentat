*MAJOR SURGERY*

Rewriting in a different agent framework